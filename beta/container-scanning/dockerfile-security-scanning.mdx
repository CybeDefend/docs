---
title: "Dockerfile Security Scanning"
description: "Detect vulnerabilities and security issues in Dockerfile configurations and container image builds during code scanning."
---

CybeDefend's **Dockerfile Security Scanning** analyzes your Dockerfile configurations for security vulnerabilities, misconfigurations, and best practice violations. This scanning is automatically integrated into your regular code scanning process, ensuring container security is part of your development workflow.

<Frame>
  <img src="/images/container-scanning/dockerfile-scanning.png" alt="Dockerfile Security Scanning" style={{ borderRadius: '0.5rem' }} />
</Frame>

## How It Works

When CybeDefend scans your codebase, it automatically detects Dockerfile files and performs comprehensive security analysis alongside your source code scanning. This integrated approach ensures both your application code and container configurations are secure.

### Automatic Detection

CybeDefend automatically identifies and scans:
- `Dockerfile` files in your repository
- Multi-stage build configurations
- Docker Compose files with build contexts
- Custom Dockerfile variants (e.g., `Dockerfile.prod`, `Dockerfile.dev`)

### Security Analysis

The scanner examines multiple aspects of your Dockerfile:

1. **Base Image Security**
   - Identifies vulnerable base images
   - Recommends secure alternatives
   - Checks for outdated image versions

2. **Configuration Issues**
   - Detects insecure configurations
   - Identifies privilege escalation risks
   - Finds exposed sensitive data

3. **Best Practice Violations**
   - Running containers as root user
   - Missing health checks
   - Inefficient layer management

## Types of Issues Detected

<CardGroup cols={2}>
  <Card title="Vulnerable Base Images" icon="exclamation-triangle">
    Detection of base images with known CVEs and security vulnerabilities
  </Card>
  
  <Card title="Secrets Exposure" icon="eye-slash">
    Hard-coded passwords, API keys, or sensitive data in Dockerfile instructions
  </Card>
  
  <Card title="Privilege Escalation" icon="user-shield">
    Containers running as root or with unnecessary elevated privileges
  </Card>
  
  <Card title="Network Security" icon="network-wired">
    Exposed ports and insecure network configurations
  </Card>
</CardGroup>

## Common Dockerfile Security Issues

### Vulnerable Base Images
```dockerfile
# ❌ Problematic - outdated base image
FROM ubuntu:18.04

# ✅ Better - recent, patched base image
FROM ubuntu:22.04

# ✅ Best - minimal, security-focused base
FROM alpine:3.18
```

### Running as Root
```dockerfile
# ❌ Problematic - running as root
FROM node:18
COPY . /app
WORKDIR /app
RUN npm install
CMD ["npm", "start"]

# ✅ Better - create and use non-root user
FROM node:18
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001
COPY . /app
WORKDIR /app
RUN npm install
USER nextjs
CMD ["npm", "start"]
```

### Secrets in Dockerfile
```dockerfile
# ❌ Problematic - hard-coded secrets
FROM alpine
ENV API_KEY=sk-1234567890abcdef
ENV DATABASE_PASSWORD=supersecret123

# ✅ Better - use runtime environment variables
FROM alpine
ENV API_KEY=""
ENV DATABASE_PASSWORD=""
# Set these at runtime with docker run -e
```

### Unnecessary Privileges
```dockerfile
# ❌ Problematic - excessive capabilities
FROM alpine
RUN apk add --no-cache sudo
USER root

# ✅ Better - minimal privileges
FROM alpine
RUN adduser -D -s /bin/sh appuser
USER appuser
```

## Integration with Code Scanning

Dockerfile scanning is seamlessly integrated into your regular code scanning workflow:

### Automatic Inclusion
- No additional configuration required
- Scans run alongside SAST, SCA, and IaC analysis
- Results appear in the same vulnerability dashboard

### Scan Triggers
- **Repository Scans**: Includes all Dockerfiles in the repository
- **CI/CD Integration**: Scans Dockerfiles in pull requests and commits
- **Manual Scans**: On-demand analysis of container configurations

### Results Integration
- Dockerfile issues appear with other security findings
- Severity levels aligned with overall vulnerability scoring
- Remediation guidance provided for each issue

## Remediation Guidance

CybeDefend provides specific remediation advice for Dockerfile security issues:

**Base Image Updates**:
```dockerfile
# Current vulnerable image
FROM python:3.8

# Recommended secure alternative
FROM python:3.11-slim
# Or use specific SHA for immutable builds
FROM python:3.11-slim@sha256:abc123...
```

**Security Hardening**:
```dockerfile
# Add security best practices
FROM alpine:3.18

# Create non-root user
RUN addgroup -S appgroup && adduser -S appuser -G appgroup

# Install only necessary packages
RUN apk add --no-cache python3 py3-pip

# Set proper permissions
COPY --chown=appuser:appgroup . /app
WORKDIR /app

# Switch to non-root user
USER appuser

# Define health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:8080/health || exit 1

CMD ["python3", "app.py"]
```

## Best Practices Enforced

<Steps>
  <Step title="Use Minimal Base Images">
    Choose distroless or Alpine-based images to reduce attack surface
  </Step>
  
  <Step title="Run as Non-Root">
    Create and use dedicated user accounts instead of root
  </Step>
  
  <Step title="Pin Image Versions">
    Use specific tags or SHA hashes instead of 'latest'
  </Step>
  
  <Step title="Minimize Layers">
    Combine RUN commands and clean up in the same layer
  </Step>
  
  <Step title="Scan Dependencies">
    Keep base images and installed packages up to date
  </Step>
</Steps>

## Multi-Stage Build Security

For multi-stage builds, CybeDefend analyzes each stage:

```dockerfile
# Build stage - can have broader permissions
FROM node:18 AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

# Production stage - minimal and secure
FROM node:18-alpine AS production
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001
WORKDIR /app
COPY --from=builder --chown=nextjs:nodejs /app/node_modules ./node_modules
COPY --chown=nextjs:nodejs . .
USER nextjs
CMD ["npm", "start"]
```

## Continuous Security

**Development Workflow**:
- Scan Dockerfiles during development
- Integrate findings into code review process
- Block deployments with critical container security issues

**CI/CD Integration**:
- Automatic scanning on code commits
- Quality gates based on security findings
- Automated remediation suggestions

**Monitoring**:
- Track security improvements over time
- Monitor for new vulnerabilities in base images
- Alert on configuration drift

<Note>
Dockerfile security scanning is automatically enabled when you scan repositories containing Docker configurations. No additional setup is required beyond your regular code scanning configuration.
</Note>

<Tip>
Combine Dockerfile scanning with container image scanning for comprehensive container security. Scan your Dockerfiles during development and scan the built images before deployment.
</Tip>
